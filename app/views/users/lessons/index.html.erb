<div class="showLesson">
  <div class="container">
    <div class="row">
      <ul class="nav nav-tabs">
        <li role="presentation"><%= link_to '個人資料', users_path %></li>
        <li role="presentation"><%= link_to '修改密碼', edit_user_registration_path %></li>
        <% unless current_user.is_coach? %>
        <li role="presentation"><%= link_to '編輯教練資料', edit_users_coach_path %></li>
        <li role="presentation" class="active"><%= link_to '課程資訊', users_coach_lessons_path %></li>
        <% end %>
      </ul>
      <p></p>
      <div class="text-center">
        <p><a href="#" id="lesson-btn" class="btn btn-primary">新增課程</a></p>
      </div>
      <div class="col-md-10 col-md-offset-1" id="lesson-form">
        <div class="newLesson">
          <%= form_for [ @coach, @lesson], :url => users_coach_lessons_path, :html => {:class => "form-horizontal"}  do |form| %>
          <div class="col-sm-3">
            <div id="target" class="">
              <% if @lesson.photo? %>
              <%= image_tag(@coach.photo, :class => "img-responsive img-thumbnail" ) %>
              <% else %>
              <%= image_tag("coach/default.png", :class => "img-responsive img-thumbnail" )  %>
              <% end %>
            </div>
            <div class="clearfix"></div>
            <p></p><%= form.file_field :photo, :id => "pictureInput" %>
            <p class="help-block">建議上傳300x300的照片...</p>
          </div>
          <div class="col-sm-9">
            <div class="form-group">
              <%= form.label :name, "課程名稱", :class => "col-sm-2" %>
              <div class="col-sm-7">
                <%= form.text_field :name, :class => "form-control", :placeholder => "ex: 個人化健康管理" %>
              </div>
            </div>
            <div class="form-group">
              <%= form.label :suitable, "適合對象", :class => "col-sm-2" %>
              <div class="col-sm-8">
                <%= form.text_field :suitable, :class => "form-control", :placeholder => "ex: 不限年齡不限性別(特別適合23以上之上班族)" %>
              </div>
            </div>
            <div class="form-group">
              <%= form.label :attendance, "開班人數", :class => "col-sm-2" %>
              <div class="col-sm-6">
                <%= form.text_field :attendance, :class => "form-control", :placeholder => "ex: 1~9人" %>
              </div>
            </div>
            <div class="form-group">
              <%= form.label "價格區間", :class => "col-sm-2 col-xs-3" %>
              <div class="col-sm-2 col-xs-3">
                <%= form.text_field :min_price, :class => "form-control input-sm", :placeholder => "ex: 1000" %>
              </div>
              <div class="pull-left"><p>～</p></div>

              <div class="col-sm-2 col-xs-3">
                <%= form.text_field :max_price, :class => "form-control input-sm", :placeholder => "ex: 1500" %>
              </div>
              <div class="pull-left"><p>/ 每小時</p></div>
            </div>

            <div class="form-group">
              <%= form.label :content, "課程內容", :class => "col-sm-2" %>
              <div class="col-sm-10">
                <%= form.text_area :content, :class => "form-control", :placeholder => "" %>
              </div>
            </div>
            <div class="form-group">
              <%= form.label :ps, "附註", :class => "col-sm-2" %>
              <div class="col-sm-10">
                <%= form.text_field :ps, :class => "form-control" %>
              </div>
            </div>
            <div class="text-center">
              <%= form.submit "submit", :class =>"btn btn-primary"  %>

            </div>
          </div>

          <% end %>
        </div>
      </div>
      <div class="clearfix"></div>
      <div class="showLessonlist col-sm-12">
        <% @lessons.each do |lesson| %>
        <div class="lesson">
          <%= lesson.name %>
          <%= lesson.content %>
        </div>
        <% end %>
      </div>


    </div>
  </div>
</div>
<script>
  var lesson_form = $("#lesson-form")
  <% unless @lesson.errors.any? %>
    lesson_form.hide();
  <% end %>
  $("#lesson-btn").click(function(){
    lesson_form.slideToggle();
  })
$(function() {
  $('#pictureInput').on('change', function(event) {
    var files = event.target.files;
    var image = files[0]
    var reader = new FileReader();
    reader.onload = function(file) {
      var img = new Image();
      console.log(file);
      img.src = file.target.result;

      $('#target').html(img);
      $('#target img').addClass("img-responsive img-thumbnail");
    }
    reader.readAsDataURL(image);
    console.log(files);
  });
});
</script>
